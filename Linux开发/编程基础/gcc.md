# GCC常用指令

## 🚀基础编译选项

***

* `-Wall` : 分成两部分`-W`+`all`, 检测程序中各种问题

```bash
$ gcc -Wall hello.c -o hello
```

![截图](pic/001.png)

> 不需要编译`.h`文件，因为`.h`文件在`.c`文件里显式包含了，代码检查时会自动引入编译

***

* `-v` : 显示编译过程信息

```bash
$ gcc -Wall -v hello.c main.c -o test
```

![截图](pic/002.png)

***

* `-c` : 执行‘预处理’‘汇编’‘编译’步骤，生成`.o`文件

```bash
$ gcc -Wall -c main.c hello.c
```

![截图](pic/003.png)

> 无需添加`-o`选项，`-o`会调用链接器生成目标可执行文件

```bash
$ gcc main.o hello.o -o test
```

> 这里无需`-Wall`，因为`-Wall`是检查编译过程中的问题，这里只执行了链接操作

### ❗编译次序问题

> 主要针对一些比较老的编辑器

  + gcc检测文件是从右往左
  + 某个源文件需要依赖另一个源文件时需要把依赖放在前面(右边)

## 🎉库文件

> 多个目标文件`.o`打包到一个文件里，标准库一般位于`/usr/lib`或者`/lib`目录里，以`.a`为后缀名

 * 静态库 : 在类unix系统里一般以`.a`文件为主，windows中一般以`.lib`文件为主
 * 动态库 :

### 🔗手动链接外部库

> 通过在命令中添加库文件的路径(一般是相对路径)来引入外部库依赖

1. 显式指定外部库文件

```bash
$ gcc -Wall main.c /usr/lib/libm.a -o calc
```

> ⚠️注意: 指定库文件是，需要注意文件依赖顺序(右->左)

2. 使用`-l`选项指定外部库文件

```bash
$ gcc -Wall main.c -lm -o calc
```

这里的`-lm`也是一个组合选项，从系统库目录找文件，表示链接标准库目录`/usr/lib`

> ⚠️注意: 在使用库文件里面的函数时需要在源代码中包含使用到的库函数的头文件，就算你手动链接了目标函数的库文件，也会报错，因为需要显式声明

3. 指定外部库目录(✨推荐)

自包含，不需要外部环境依赖，一般在项目目录里创建目录

* `-I` : 指定头文件搜索目录

* `-L` : 指定库文件搜索目录

4. 设置系统环境变量

* `C_INCLUDE_PATH` : 指定头文件目录

* `LIBRARY_PATH` : 指定库文件目录


### 🔧手动创建库文件

+ 创建库

```bash
$ ar cr lib_name.a file1.o file2.o file3.o
```

+ 查看库文件里有多少个目标文件
```bash
$ ar t lib_name.a
```
