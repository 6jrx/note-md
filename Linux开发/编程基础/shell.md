# ğŸ˜‹å¸¸ç”¨shellç¨‹åº

* /bin/bash ï¼š ä¸€èˆ¬linuxå‘è¡Œç‰ˆé»˜è®¤ä½¿ç”¨çš„shellç¨‹åº

* /bin/sh ï¼šè¿™æ˜¯æœ€å¤è€çš„ã€ç»å…¸çš„Unix Shellï¼Œå®ƒæ˜¯è®¸å¤šç°ä»£Shellçš„â€œç¥–å…ˆâ€

* /bin/csh ï¼š ä½¿ç”¨Cè¯­è¨€é£æ ¼çš„è¯­æ³•ï¼Œæ›¾æ˜¯äº¤äº’å¼ä½¿ç”¨çš„çƒ­é—¨é€‰æ‹©ï¼Œä½†ç°åœ¨å·²åŸºæœ¬è¢«æ›´ç°ä»£çš„Shellï¼ˆå¦‚ Zsh, Fishï¼‰å–ä»£ï¼Œä¸æ¨èä½¿ç”¨

* /bin/ksh : åœ¨Bashæµè¡Œä¹‹å‰ï¼Œå®ƒæ˜¯BourneShellçš„ä¸€ä¸ªé‡è¦å¢å¼ºç‰ˆï¼Œå¯¹åæ¥çš„Bashå’ŒZshéƒ½æœ‰å¾ˆå¤§å½±å“ã€‚ç°åœ¨ä»æœ‰ä¸€äº›è€ç‰ŒUnixç³»ç»Ÿï¼Œå¦‚AIXåœ¨ä½¿ç”¨

* /bin/zsh : Zshè¢«çœ‹ä½œæ˜¯Bashçš„ä¸€ä¸ªå¼ºå¤§çš„â€œç°ä»£åŒ–â€æ›¿ä»£å“ï¼Œå®ƒå¸æ”¶äº†Bash,Ksh,Tcshç­‰å…¶ä»–Shellçš„ä¼˜ç‚¹ï¼ŒåŠŸèƒ½æå…¶å¼ºå¤§

* /bin/fish ï¼š Fishçš„è®¾è®¡å®—æ—¨æ˜¯â€œå¼€ç®±å³ç”¨â€ï¼Œæä¾›ä¸€æµçš„äº¤äº’ä½“éªŒï¼Œæ— éœ€å¤æ‚çš„é…ç½®

æ ¸å¿ƒåŒºåˆ«æ€»ç»“è¡¨

| ç‰¹æ€§ | **Bash (Bourne-Again)** | **Zsh (Z Shell)** | **Fish (Friendly)** | **Sh (Bourne)** |
| :--- | :--- | :--- | :--- | :--- |
| **äº¤äº’ä½“éªŒ** | è‰¯å¥½ | **ä¼˜ç§€**ï¼ˆéœ€é…ç½®ï¼‰ | **æä½³**ï¼ˆå¼€ç®±å³ç”¨ï¼‰ | å¾ˆå·® |
| **è„šæœ¬å…¼å®¹æ€§** | **æé«˜**ï¼ˆLinux æ ‡å‡†ï¼‰ | é«˜ï¼ˆå…¼å®¹å¤§éƒ¨åˆ† Bashï¼‰ | ä½ï¼ˆè‡ªæœ‰è¯­æ³•ï¼‰ | **æœ€é«˜**ï¼ˆPOSIX æ ‡å‡†ï¼‰ |
| **å¯é…ç½®æ€§** | é«˜ï¼ˆéœ€æ‰‹åŠ¨é…ç½®ï¼‰ | **æé«˜**ï¼ˆOh My Zsh ç­‰ï¼‰ | ä¸­ï¼ˆå¼€ç®±å³ç”¨ï¼‰ | å¾ˆä½ |
| **è‡ªåŠ¨è¡¥å…¨** | åŸºç¡€ | **å¼ºå¤§**ï¼ˆå¯æ‰©å±•ï¼‰ | **å¼ºå¤§**ï¼ˆè‡ªå¸¦ï¼‰ | æ—  |
| **æ€§èƒ½é€Ÿåº¦** | è‰¯å¥½ | è‰¯å¥½ | è‰¯å¥½ | **æå¿«**ï¼ˆè½»é‡ï¼‰ |
| **å­¦ä¹ æ›²çº¿** | å¹³ç¼“ | ä¸­ç­‰ | **å¹³ç¼“**ï¼ˆå¯¹æ–°æ‰‹å‹å¥½ï¼‰ | é™¡å³­ï¼ˆå·²è¿‡æ—¶ï¼‰ |
| **é»˜è®¤ç³»ç»Ÿ** | å¤šæ•° Linux | macOS (since Catalina) | - | è„šæœ¬æ ‡å‡† |


æŸ¥çœ‹å½“å‰ç³»ç»Ÿæœ‰å“ªäº›shellç¨‹åº

```bash
$ cat /etc/shells
# Pathnames of valid login shells.
# See shells(5) for details.

/bin/sh
/bin/bash
/bin/rbash
/usr/bin/sh
/usr/bin/bash
/usr/bin/rbash
/usr/bin/systemd-home-fallback-shell
/usr/bin/git-shell
/bin/zsh
/usr/bin/zsh
```

æŸ¥çœ‹å½“å‰ç”¨æˆ·ä½¿ç”¨çš„shell

```bash
$ cat /etc/passwd | grep $USER
lj:x:1000:1000::/home/lj:/usr/bin/zsh
```

## ğŸ¤–bashåŸºæœ¬ç‰¹æ€§

* å¿«æ·é”®

  `Ctrl + l`

  `Ctrl + c`

  `Ctrl + a`

  `Ctrl + e`

  `Ctrl + .`

* tabé”®è¡¥å…¨

  `<tab>`

* å†å²å‘½ä»¤

  `history`

* æ ‡å‡†è¾“å…¥ä¸è¾“å‡ºé‡å®šå‘

  `>` / `2>` / `>>` / `&>` / `<`

* ç®¡é“

  `|`


# ğŸ˜»å‘½ä»¤è¡Œ

## å¸¸ç”¨å‘½ä»¤

* ls : æŸ¥çœ‹æ–‡ä»¶å’Œç›®å½•

* cat : è¯»å–æŒ‡å®šæ–‡ä»¶å†…å®¹

* grep : è¿‡æ»¤è¾“å‡ºçš„å†…å®¹

* echo : è¾“å‡ºæ–‡æœ¬åˆ°æ ‡å‡†è¾“å‡º

* cd : åˆ‡æ¢ç›®å½•

## ğŸ‘æƒé™ç®¡ç†å‘½ä»¤

* chmod : ä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•æƒé™

* chown : ä¿®æ”¹æ–‡ä»¶å½’å±


## ğŸ’¨æ‰§è¡Œå‘½ä»¤çš„æ–¹å¼

1. äº¤äº’å¼

æ‰§è¡Œå‘½ä»¤ç¨‹åº

2. éäº¤äº’å¼

æ‰§è¡Œè„šæœ¬ç¨‹åº

* ç¼–å†™ç¬¬ä¸€ä¸ªè„šæœ¬ç¨‹åº

```bash
#!/bin/bash

echo "Hello shell."
```

> âš ï¸æ³¨æ„ï¼šç¬¬ä¸€è¡Œçš„æ³¨é‡Šä¸ºå›ºå®šå†™æ³•ï¼ŒæŒ‡å®šshellè§£é‡Šå™¨ï¼Œå…¶ä»–è¡Œä»¥#å¼€å¤´çš„éƒ½æ˜¯æ™®é€šæ³¨é‡Š


3. æ‰§è¡Œè„šæœ¬çš„æ–¹å¼

* èµ‹äºˆæ–‡ä»¶æ‰§è¡Œæƒé™

```bash
$ chmod +x test.sh
$ ./test.sh
```

* ä½¿ç”¨shellç¨‹åºæ‰§è¡Œè„šæœ¬

```bash
$ sh test.sh
```

> é»˜è®¤å¼€å¯å­è¿›ç¨‹æ¥æ‰§è¡Œè„šæœ¬

```bash
$ source test.sh
```

> ä¸ä¼šå¯åŠ¨å­è¿›ç¨‹æ‰§è¡Œ

# ğŸ¦·è¯­æ³•è§„åˆ™

## ğŸ‘å˜é‡

### å®šä¹‰å˜é‡

```bash
$ abc=123
```
> å˜é‡å®šä¹‰è§„åˆ™ï¼š1.é»˜è®¤ä¸è¦ä¿®æ”¹ç³»ç»Ÿç¯å¢ƒå˜é‡ 2.ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ 3.ä¸èƒ½æœ‰ç‰¹æ®Šç¬¦å·

* ä½¿ç”¨æˆ–æŸ¥çœ‹å˜é‡

```bash
$ echo $abc
# å°†å˜é‡ç”¨{}åŒ…èµ·æ¥å°±å¯ä»¥æ‹¼æ¥å…¶ä»–å†…å®¹
$ echo ${abc}
```

### å–æ¶ˆå˜é‡

```bash
$ unset abc
```

### å˜é‡ç±»å‹

1. ç¯å¢ƒå˜é‡

> ç³»ç»Ÿåœ¨å¯åŠ¨çš„æ—¶å€™åŠ è½½åˆ°ç¯å¢ƒé‡Œçš„å˜é‡

2. ä½ç½®å˜é‡

`$1` / `$2` / `$3`

> æ‰§è¡Œè„šæœ¬æ—¶å€™å‚æ•°çš„ä½ç½®

3. é¢„å®šä¹‰å˜é‡

  `$0` : å½“å‰æ‰€åœ¨è¿›ç¨‹æˆ–è„šæœ¬å
  `$$` : å½“å‰è¿è¡Œäº¬åŸçš„PIDå·
  `$?` : å‘½ä»¤æ‰§è¡Œåçš„è¿”å›çŠ¶æ€ï¼Œ0è¡¨ç¤ºæ­£å¸¸ï¼Œ1æˆ–å…¶ä»–å€¼ä¾¿æ˜¯å¼‚å¸¸
  `$#` : å·²åŠ è½½çš„ä½ç½®å˜é‡çš„ä¸ªæ•°
  `$*` : æ‰€æœ‰ä½ç½®å˜é‡çš„å€¼

4. è‡ªå®šä¹‰å˜é‡

> åœ¨å‘½åè§„åˆ™é™åˆ¶å†…éšæ„æŒ‡å®šå˜é‡

### å˜é‡ä½œç”¨åŸŸ

1. å…¨å±€å˜é‡

ä½¿ç”¨`export a=1`å®šä¹‰çš„å˜é‡æ˜¯å…¨å±€å˜é‡

2. å±€éƒ¨å˜é‡

å¸¸è§„æ–¹æ³•å®šä¹‰çš„å˜é‡`a=1`éƒ½æ˜¯å±€éƒ¨å˜é‡ï¼Œåªåœ¨å½“å‰è¿›ç¨‹æœ‰æ•ˆ

### ç®—å¼è¿ç®—

ä½¿ç”¨`$[]`æˆ–`$(())`è¡¨è¾¾å¼

```bash
$ echo $[2+8]
$ x=2
$ y=3
$ echo $((x*y))
```

ä½¿ç”¨`let`è¿ç®—ä¸è¾“å‡ºè¿ç®—ç»“æœ

```bash
$ x=1
$ let x++
$ echo $x
```

ä»¥ä¸Šæ–¹æ³•ä¹‹èƒ½æ”¯æŒæ•´æ•°è¿ç®—ï¼Œå°æ•°è¿ç®—éœ€è¦ç”¨`bc`å‘½ä»¤æ”¯æŒï¼Œå¯ä»¥äº¤äº’å’Œéäº¤äº’æ‰§è¡Œ

```bash
# æµ®ç‚¹æ•°è®¡ç®—ï¼Œéäº¤äº’æ‰§è¡Œ
$ echo "1.2+3.3" | bc
# å¯ä»¥åŒæ—¶è®¡ç®—å¤šä¸ªï¼Œç”¨åˆ†å·éš”å¼€
$ echo "1.2+3.3;3.8*2.7" | bc
# ä¹Ÿå¯ä»¥æŒ‡å®šå°æ•°ä½ä¿ç•™ä½æ•°
$ echo "scale=2;10/3" | bc
```

## ğŸ‘¨ğŸ»â€ğŸ¦½â€â¡ï¸å¼•å·

* åŒå¼•å· ï¼š å…è®¸æ‰©å±•ï¼Œç”¨$å¼•ç”¨å…¶ä»–å˜é‡

* å•å¼•å· ï¼š ç¦ç”¨æ‰©å±•ï¼Œå³ä¾¿$ä¹Ÿè§†ä¸ºæ™®é€šå­—ç¬¦

* åå¼•å· ï¼š å°†å‘½ä»¤çš„è¾“å‡ºä½œä¸ºå˜é‡å€¼èµ‹å€¼ç»™å˜é‡ï¼Œ$()ä¸åå¼•å·ç­‰æ•ˆ

## ğŸ‘§ğŸ»read

ä½¿ç”¨readå‘½ä»¤ç»™ä¸€ä¸ªæŒ‡å®šçš„å˜é‡èµ‹å€¼(ç­‰å¾…è¾“å…¥)ï¼Œä¸€èˆ¬ç”¨åœ¨è„šæœ¬æ‰§è¡Œè¿‡ç¨‹ä¸­äº¤äº’å¼èµ‹å€¼

```bash
$ read iname
# ä¼šåœ¨è¿™ä¸€è¡Œç­‰å¾…è¾“å…¥å†…å®¹åå›è½¦
```

ä¹Ÿå¯ä»¥æŒ‡å®šä¸€äº›æç¤ºä¿¡æ¯è¾“å‡ºåˆ°å±å¹•

```bash
$ read -p "è¯·è¾“å…¥ç”¨æˆ·åï¼š" iname
# è¿™ä¸€è¡Œè¾“å‡ºæç¤ºä¿¡æ¯å¹¶ç­‰å¾…è¾“å…¥
```

è„šæœ¬ä¸­ä½¿ç”¨

```bash
#!/bin/bash
$ read -p "è¯·è¾“å…¥ç”¨æˆ·åï¼š" name
$ read -s -p "è¯·è¾“å…¥å¯†ç ï¼š" pass
# æ·»åŠ ç”¨æˆ·å¹¶è®¾ç½®ä¸Šé¢è¾“å…¥çš„å¯†ç 
$ useradd $name
$ echo "$pass" | passwd --stdin $name
```

é€‰é¡¹è¯´æ˜

`-s` : ä¸æ˜¾ç¤ºè¾“å…¥çš„å†…å®¹ï¼Œå¸¸ç”¨äºè¾“å…¥å¯†ç æ—¶

`-p` : åœ¨å±å¹•ä¸Šè¾“å‡ºæç¤ºä¿¡æ¯

`-t` : å¯ä»¥æŒ‡å®šç­‰å¾…è¾“å…¥çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ `read -t 3 iname`

## ğŸ‘¨â€ğŸ³echo

è¾“å‡ºä¿¡æ¯åˆ°å±å¹•

```bash
$ echo "hello world"
```

å–æ¶ˆæ¢è¡Œï¼Œä½¿ç”¨`-n`é€‰é¡¹

```bash
$ echo -n "hello world"
```

ä½¿ç”¨æ‰©å±•å±æ€§ï¼Œæ¯”å¦‚æ·»åŠ æ˜¾ç¤ºé¢œè‰²

```bash
# \033è¡¨ç¤ºå¼€å¯æˆ–å…³é—­é¢œè‰²å±æ€§ï¼Œ32mæ˜¯æŒ‡å®šé¢œè‰²ä¸ºç»¿è‰²ï¼Œ0mæ˜¯é»‘è‰²
# éœ€è¦å…¶ä»–é¢œè‰²å¯ä»¥è‡ªè¡ŒæŸ¥æ‰¾é¢œè‰²è¡¨
$ echo -e "\033[32mOK\033[0m"
```

# ğŸ©é€»è¾‘åˆ†æ”¯

## ğŸ‘—åˆ¤æ–­

è¯­æ³•æ ¼å¼

* `test` : ä½¿ç”¨å‘½ä»¤å½¢å¼æ¥è¿›è¡Œåˆ¤æ–­

```bash
# test é€‰é¡¹ å‚æ•°

test 
```


* `[ ]`  : ä½¿ç”¨ç¬¦å·æ¥è¿›è¡Œåˆ¤æ–­


### å¸¸ç”¨é€‰é¡¹ï¼š

1. å­—ç¬¦ä¸²æ¯”è¾ƒ
```text
æ³¨æ„ç©ºæ ¼ä¸ºå›ºå®šæ ¼å¼ï¼Œä¸èƒ½çœç•¥

æ˜¯å¦ä¸ºç©ºï¼š[ -z å­—ç¬¦ä¸² ]

ç­‰äºï¼š[ å­—ç¬¦ä¸²1 == å­—ç¬¦ä¸²2 ]

ä¸ç­‰äºï¼š[ å­—ç¬¦ä¸²1 != å­—ç¬¦ä¸²2 ]
```

æµ‹è¯•ï¼š
```bash
$ [ -z "$zz" ]
$ echo $?         # $?è¿™ä¸ªå˜é‡è¡¨ç¤ºä¸Šä¸€ä¸ªå‘½ä»¤æ‰§è¡Œçš„ç»“æœ
```

2. æ•°å€¼æ¯”è¾ƒ

| æ“ä½œç¬¦ | å«ä¹‰ |
|-------|-------|
| `-eq` | ç­‰äº |
| `-ne` | ä¸ç­‰äº |
| `-ge` | å¤§äºæˆ–ç­‰äº |
| `-le` | å°äºæˆ–ç­‰äº |
| `-gt` | å¤§äº |
| `-lt` | å°äº |

æµ‹è¯•
```bash
# åˆ¤æ–­å½“å‰ç™»å½•ç”¨æˆ·æ•°æ˜¯å¦å¤§äºç­‰äº2
$ [ $(who | wc -l) -ge 2 ]
```

3. æ–‡ä»¶æˆ–ç›®å½•

| æ“ä½œç¬¦ | å«ä¹‰ |
| ------ | ----- |
| `-e` | åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜åœ¨|
| `-d` | åˆ¤æ–­æ˜¯å¦ä¸ºç›®å½• |
| `-f` | åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºä¸€èˆ¬æ–‡ä»¶ |
| `-r` | åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰å¯è¯»æƒé™ |
| `-w` | åˆ¤æ–­å¯¹è±¡æ˜¯å¦æœ‰å¯å†™æƒé™ |
| `-x` | å¯¹è±¡æ˜¯å¦æœ‰å¯æ‰§è¡Œæƒé™ |

### æ§åˆ¶ç¬¦

`;` : æŒ‰é¡ºåºæ‰§è¡Œï¼Œæ²¡æœ‰é€»è¾‘å…³è”

`&&` : ä¸æ‰§è¡Œï¼Œä»…å½“å‰ä¸€æ¡å‘½ä»¤æ‰§è¡ŒæˆåŠŸæ—¶æ‰æ‰§è¡Œåé¢çš„

`||` : æˆ–æ‰§è¡Œï¼Œåªè¦æœ‰ä¸€ä¸ªæ‰§è¡ŒæˆåŠŸå°±æ˜¯çœŸ

### å¸¸ç”¨ç»„åˆå‘½ä»¤

* `tr`  : å‰”é™¤å¤šä½™çš„æŒ‡å®šå­—ç¬¦

```bash
# åˆ é™¤å¤šä½™ç©ºæ ¼(æˆ–è€…å…¶ä»–é‡å¤å­—ç¬¦)
$ echo "a   b   c" | tr -s " "
```

* `cat` : è¿‡æ»¤åˆ—æ•°æ®(grepæ˜¯è¿‡æ»¤è¡Œæ•°æ®)

```bash
# ä»¥å†’å·ä¸ºåˆ†éš”ç¬¦ï¼Œè¿‡æ»¤ç¬¬ä¸€åˆ—
$ cut -d: -f1 /etc/passwd
```

## ğŸ§™ğŸ»â€â™€ï¸ifè¯­å¥

* å•åˆ†æ”¯

```bash
#!/bin/bash
# åˆ›å»ºç”¨æˆ·ï¼Œåˆ¤æ–­ç”¨æˆ·åå¯†ç æ˜¯å¦ä¸ºç©º

read -p "è¯·è¾“å…¥ç”¨æˆ·åï¼š" user
read -s -p "è¯·è¾“å…¥å¯†ç ï¼š" pass
if [ ! -z "$user" ];then
  useradd "$user"
fi

if [ ! -z "$pass" ];then
  echo "$pass" | passwd --stdin "$user"
fi
# è¾“å‡ºæ¢è¡Œ
echo
```

* åŒåˆ†æ”¯

æ¡ˆä¾‹1

```bash
#!/bin/bash
# ä¸»æœºpingæµ‹è¯•

if [ -z "$1" ]; then
  echo -n "ç”¨æ³•: è„šæœ¬"
  echo -e "\033[32måŸŸåæˆ–IP\033[0m"
  exit
fi

ping -c2 -i0.1 -W1 "$1" &> /dev/null

if [ $? -eq 0];then
  echo "$1 is up"
else
  echo "$1 is down"
fi
echo
```

æ¡ˆä¾‹2

```bash
#!/bin/bash
# çŒœæ•°å­—ï¼›ç”¨éšæœºå˜é‡ç”Ÿæˆä¸€ä¸ª10ä»¥å†…çš„éšæœºæ•°

clear
num=$[RANDOM%10+1]
read -p "è¯·è¾“å…¥1-10ä¹‹é—´çš„æ•´æ•°ï¼š" guess
if [ $guess -eq $num ]; then
  echo "æ­å–œçŒœå¯¹äº†ï¼Œå°±æ˜¯:$num"
elif [ $guess -lt $num ]; then
  echo "çŒœå°äº†"
else
  echo "çŒœå¤§äº†"
fi
echo
```


## ğŸ›€ğŸ»forè¯­å¥

æ¡ˆä¾‹1

```bash
#!/bin/bash
# å¾ªç¯è¾“å‡ºæŒ‡å®šåˆ—è¡¨å€¼
for i in 11 22 33 44 55  # {1..10} ç®€å†™çš„1-10åˆ—è¡¨
do
  echo "I am $i"
done
echo
```

æ¡ˆä¾‹2

```bash
#!/bin/bash
# æŒ‡å®šæ­¥é•¿çš„å¾ªç¯
for ((i=1;i<=5;i++))
do
  echo "I am $i"
done
echo
```


