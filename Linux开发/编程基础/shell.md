# 😋常用shell程序

* /bin/bash ： 一般linux发行版默认使用的shell程序

* /bin/sh ：这是最古老的、经典的Unix Shell，它是许多现代Shell的“祖先”

* /bin/csh ： 使用C语言风格的语法，曾是交互式使用的热门选择，但现在已基本被更现代的Shell（如 Zsh, Fish）取代，不推荐使用

* /bin/ksh : 在Bash流行之前，它是BourneShell的一个重要增强版，对后来的Bash和Zsh都有很大影响。现在仍有一些老牌Unix系统，如AIX在使用

* /bin/zsh : Zsh被看作是Bash的一个强大的“现代化”替代品，它吸收了Bash,Ksh,Tcsh等其他Shell的优点，功能极其强大

* /bin/fish ： Fish的设计宗旨是“开箱即用”，提供一流的交互体验，无需复杂的配置

核心区别总结表

| 特性 | **Bash (Bourne-Again)** | **Zsh (Z Shell)** | **Fish (Friendly)** | **Sh (Bourne)** |
| :--- | :--- | :--- | :--- | :--- |
| **交互体验** | 良好 | **优秀**（需配置） | **极佳**（开箱即用） | 很差 |
| **脚本兼容性** | **极高**（Linux 标准） | 高（兼容大部分 Bash） | 低（自有语法） | **最高**（POSIX 标准） |
| **可配置性** | 高（需手动配置） | **极高**（Oh My Zsh 等） | 中（开箱即用） | 很低 |
| **自动补全** | 基础 | **强大**（可扩展） | **强大**（自带） | 无 |
| **性能速度** | 良好 | 良好 | 良好 | **极快**（轻量） |
| **学习曲线** | 平缓 | 中等 | **平缓**（对新手友好） | 陡峭（已过时） |
| **默认系统** | 多数 Linux | macOS (since Catalina) | - | 脚本标准 |


查看当前系统有哪些shell程序

```bash
$ cat /etc/shells
# Pathnames of valid login shells.
# See shells(5) for details.

/bin/sh
/bin/bash
/bin/rbash
/usr/bin/sh
/usr/bin/bash
/usr/bin/rbash
/usr/bin/systemd-home-fallback-shell
/usr/bin/git-shell
/bin/zsh
/usr/bin/zsh
```

查看当前用户使用的shell

```bash
$ cat /etc/passwd | grep $USER
lj:x:1000:1000::/home/lj:/usr/bin/zsh
```

## 🤖bash基本特性

* 快捷键

  `Ctrl + l`

  `Ctrl + c`

  `Ctrl + a`

  `Ctrl + e`

  `Ctrl + .`

* tab键补全

  `<tab>`

* 历史命令

  `history`

* 标准输入与输出重定向

  `>` / `2>` / `>>` / `&>` / `<`

* 管道

  `|`


# 😻命令行

## 常用命令

* ls : 查看文件和目录

* cat : 读取指定文件内容

* grep : 过滤输出的内容

* echo : 输出文本到标准输出

* cd : 切换目录

## 👏权限管理命令

* chmod : 修改文件或目录权限

* chown : 修改文件归属


## 💨执行命令的方式

1. 交互式

执行命令程序

2. 非交互式

执行脚本程序

* 编写第一个脚本程序

```bash
#!/bin/bash

echo "Hello shell."
```

> ⚠️注意：第一行的注释为固定写法，指定shell解释器，其他行以#开头的都是普通注释


3. 执行脚本的方式

* 赋予文件执行权限

```bash
$ chmod +x test.sh
$ ./test.sh
```

* 使用shell程序执行脚本

```bash
$ sh test.sh
```

> 默认开启子进程来执行脚本

```bash
$ source test.sh
```

> 不会启动子进程执行

# 🦷语法规则

## 👁变量

### 定义变量

```bash
$ abc=123
```
> 变量定义规则：1.默认不要修改系统环境变量 2.不能以数字开头 3.不能有特殊符号

* 使用或查看变量

```bash
$ echo $abc
# 将变量用{}包起来就可以拼接其他内容
$ echo ${abc}
```

### 取消变量

```bash
$ unset abc
```

### 变量类型

1. 环境变量

> 系统在启动的时候加载到环境里的变量

2. 位置变量

`$1` / `$2` / `$3`

> 执行脚本时候参数的位置

3. 预定义变量

  `$0` : 当前所在进程或脚本名
  `$$` : 当前运行京城的PID号
  `$?` : 命令执行后的返回状态，0表示正常，1或其他值便是异常
  `$#` : 已加载的位置变量的个数
  `$*` : 所有位置变量的值

4. 自定义变量

> 在命名规则限制内随意指定变量

### 变量作用域

1. 全局变量

使用`export a=1`定义的变量是全局变量

2. 局部变量

常规方法定义的变量`a=1`都是局部变量，只在当前进程有效

### 算式运算

使用`$[]`或`$(())`表达式

```bash
$ echo $[2+8]
$ x=2
$ y=3
$ echo $((x*y))
```

使用`let`运算不输出运算结果

```bash
$ x=1
$ let x++
$ echo $x
```

以上方法之能支持整数运算，小数运算需要用`bc`命令支持，可以交互和非交互执行

```bash
# 浮点数计算，非交互执行
$ echo "1.2+3.3" | bc
# 可以同时计算多个，用分号隔开
$ echo "1.2+3.3;3.8*2.7" | bc
# 也可以指定小数位保留位数
$ echo "scale=2;10/3" | bc
```

## 👨🏻‍🦽‍➡️引号

* 双引号 ： 允许扩展，用$引用其他变量

* 单引号 ： 禁用扩展，即便$也视为普通字符

* 反引号 ： 将命令的输出作为变量值赋值给变量，$()与反引号等效

## 👧🏻read

使用read命令给一个指定的变量赋值(等待输入)，一般用在脚本执行过程中交互式赋值

```bash
$ read iname
# 会在这一行等待输入内容后回车
```

也可以指定一些提示信息输出到屏幕

```bash
$ read -p "请输入用户名：" iname
# 这一行输出提示信息并等待输入
```

脚本中使用

```bash
#!/bin/bash
$ read -p "请输入用户名：" name
$ read -s -p "请输入密码：" pass
# 添加用户并设置上面输入的密码
$ useradd $name
$ echo "$pass" | passwd --stdin $name
```

选项说明

`-s` : 不显示输入的内容，常用于输入密码时

`-p` : 在屏幕上输出提示信息

`-t` : 可以指定等待输入的时间，单位是秒 `read -t 3 iname`

## 👨‍🍳echo

输出信息到屏幕

```bash
$ echo "hello world"
```

取消换行，使用`-n`选项

```bash
$ echo -n "hello world"
```

使用扩展属性，比如添加显示颜色

```bash
# \033表示开启或关闭颜色属性，32m是指定颜色为绿色，0m是黑色
# 需要其他颜色可以自行查找颜色表
$ echo -e "\033[32mOK\033[0m"
```

# 🎩逻辑分支

## 👗判断

语法格式

* `test` : 使用命令形式来进行判断

```bash
# test 选项 参数

test 
```


* `[ ]`  : 使用符号来进行判断


### 常用选项：

1. 字符串比较
```text
注意空格为固定格式，不能省略

是否为空：[ -z 字符串 ]

等于：[ 字符串1 == 字符串2 ]

不等于：[ 字符串1 != 字符串2 ]
```

测试：
```bash
$ [ -z "$zz" ]
$ echo $?         # $?这个变量表示上一个命令执行的结果
```

2. 数值比较

| 操作符 | 含义 |
|-------|-------|
| `-eq` | 等于 |
| `-ne` | 不等于 |
| `-ge` | 大于或等于 |
| `-le` | 小于或等于 |
| `-gt` | 大于 |
| `-lt` | 小于 |

测试
```bash
# 判断当前登录用户数是否大于等于2
$ [ $(who | wc -l) -ge 2 ]
```

3. 文件或目录

| 操作符 | 含义 |
| ------ | ----- |
| `-e` | 判断对象是否存在|
| `-d` | 判断是否为目录 |
| `-f` | 判断对象是否为一般文件 |
| `-r` | 判断对象是否有可读权限 |
| `-w` | 判断对象是否有可写权限 |
| `-x` | 对象是否有可执行权限 |

### 控制符

`;` : 按顺序执行，没有逻辑关联

`&&` : 与执行，仅当前一条命令执行成功时才执行后面的

`||` : 或执行，只要有一个执行成功就是真

