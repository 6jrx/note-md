## 应急响应流程

- 事件发生
  - 通过安全监控设备的上报
  - 服务器异常表现
- 事件确认及分类
  - 收集事件信息
  - 分析网络活动日志等
  - 评估事件严重性危险等级
  - 上报相关部门
- 事件响应
  - 通过相应技术防御手段消除攻击影响
  - 检查攻击点避免存在漏洞点
  - 入侵检查等
- 事件关闭
  - 处理完事件后关闭事件
  - 写处理分析报告

<br/>

## 时间分析及结论

病毒、木马、蠕虫事件

Web服务器入侵事件

第三方服务入侵事件

个人系统入侵事件

网络攻击事件

<br/>

## 分析方向

### 1）文件分析

#### 0x01 文件日期

```sh
# 查看具体时间
ls --full-time /root/temp
```

#### 0x02 文件增改

```sh
# 通过md5值查看文件是否被修改
md5sum /root/temp/door.hta
```

#### 0x03 最近使用文件

```sh
# 查找最难2分钟修改过的文件
find /etc -mmin -2
```

<br/>

### 2）日志分析

#### 0x01 Linux日志

```sh
# 系统应用日志
cd /var/log

```

#### 0x02 Windows日志

```sh

```

### 3）内存分析

#### 0x01 Linux

```sh
# 1、查看系统运行状况
top
# 2、查看系统进程
ps -ef
# 3、查看系统启动任务
systemctl list-unit-files

# 4、查看任务计划
crontab -l
ls cron*
```

#### 0x02 Windows

```sh
# 1、任务管理器

```

### 4）网络分析

#### 0x01 Linux

```sh
ss -tlp
netstat -antup
# 查看正在监听的端口
netstat -ntplu
```

#### 0x02 Windows

```sh
netstat | findstring ""
```

### 5）配置文件

linux 

```sh
getenforce
iptabls -L
echo $PATH
```

windows

```sh
#默认防火墙

#path

certutil.exe -hashfile 文件路径
```

### 6）监控软件

zabbix

<br/>

## DHCP & DNS劫持攻击

1、用内网攻陷的服务器搭建DHCP服务，配置一个提前准备的的DNS服务器IP，让DNS解析都走这个可控的DNS服务，实现DNS劫持攻击。

2、修改目标机器的hosts文件，将指定域名解析到钓鱼网页，实现DNS劫持攻击

> 修复方式：1、手动设定网络地址信息  2、在路由器设定可信DHCP

## ARP攻击

攻击

1、使用arpspoof工具 

      安装：`sudo apt-get install dsniff`   

      使用：`arpspoof -i eth0 -t 目标 -r 网关`

<br/>

防御：

1、arp绑定

2、arp防火墙(360杀毒自带)

3、网络接入认证，拒绝非实名认证设备接入网络

<br/>

## DDOS攻击

一种以将目标主机服务资源占用完的恶意攻击手段，通常分为一下三种；

<br/>

a) CC攻击：模拟HTTP请求攻击WEB页面，耗尽WEB服务资源使服务崩溃；通过curl脚本多台**攻击机循环请求**。耗尽目标上传带宽。

排查：通过http日志查看攻击者地址等异常链接请求

<br/>

b) SYN攻击：使用`hping`命令发送tcp三次握手流量，不过请求是经过修改的不可到达的ip地址，服务器在回应的时候就会找不到主机，导致确认包无法发出，就会进入挂起状态，占用系统资源。

攻击命令`hping3 -I eth0 -S 107.182.190.222 -p 80 --rand-source --flood`

查看资源`netstat -an | grep tcp | SYN_RECV | wc -l`

<br/>

c) 纯流量攻击：使用脚本往指定端口循环发送大流量包的请求，将目标服务器的下载带宽耗净。

排查：使用流量监控软件查看